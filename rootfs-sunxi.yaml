{{- $architecture := or .architecture "arm64" -}}
{{- $device := or .device "pinephone" }}

architecture: {{ $architecture }}

actions:
  - action: unpack
    file: rootfs-{{ $architecture }}.tar.gz

{{ if eq $device "pinephone" }}
  - action: apt
    recommends: false
    description: Install telephony packages
    packages:
      - mobian-phosh-phone
      - firefox-esr-mobile-config
      - flashlight
{{ end }}

  - action: apt
    recommends: false
    description: Install device-specific packages
    packages:
      - {{ $device }}-support
      - megapixels
      - powersupply

  - action: pack
    file: rootfs-{{ $device }}.tar.gz
